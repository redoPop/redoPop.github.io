const rand=e=>Math.random()*e;function drawCloud(e,{x:t,y:n,scale:s,color:o}){e.beginPath(),e.fillStyle=`rgb(${[Math.floor(o*.4),Math.floor(o*.3),o].join(",")})`,e.arc(t,n,30*s,0,2*Math.PI),e.arc(t+80*s,n-25*s,30*s,0,2*Math.PI),e.closePath(),e.arc(t+32*s,n-35*s,35*s,0,2*Math.PI),e.arc(t+105*s,n,30*s,0,2*Math.PI),e.fillRect(t,n-10*s,105*s,40*s),e.fill()}function generateClouds(e,t){const s=[],i=Math.floor(e/160),n=Math.min(i,4),o=Math.ceil(e/n);for(let e=0;e<n;e++)s.push({x:o*e+rand(o),y:50+rand(Math.min(t,300)),scale:rand(e/n+n/3)+.8});return s.sort(({scale:e},{scale:t})=>e<t?-1:e>t?1:0).map((e,t)=>Object.assign(e,{color:60+Math.floor(t*(40/n))}))}const nudgeClouds=(e,t)=>e.forEach(e=>{e.x+=.15*(e.scale*1.4),e.x>t+30*e.scale&&(e.x=0-135*e.scale)});function startRenderLoop(e){let t=0;function n(s){s-t>24&&(e(),t=s),requestAnimationFrame(n)}n()}function watchViewport(e){const t={};let n;function s(){t.width=window.innerWidth,t.height=window.innerHeight}function o(){s(),n&&clearTimeout(n),n=setTimeout(e,100,t)}return window.addEventListener("resize",o,!1),s(),e(t),t}{const n=document.getElementById("clouds"),t=n.getContext("2d"),o=window.matchMedia("(prefers-reduced-motion: reduce)").matches,e=watchViewport(({width:e,height:t})=>{n.width=e,n.height=t}),s=generateClouds(e.width,e.height),i=e.width;startRenderLoop(()=>{const n=Math.max(i,e.width);o||nudgeClouds(s,n),t.canvas.width=e.width,t.canvas.height=e.height,t.clearRect(0,0,e.width,e.height),s.forEach(e=>drawCloud(t,e))})}